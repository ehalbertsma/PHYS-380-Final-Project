\chapter{Theory}
\section{Background information}
Seismic faults are planar fractures/discontinuities typically caused by significant displacements in solid ground.

% explain what waves exist in seismology
Two particular types of waves caused by seismic faults are $p$-waves and $s$-waves. The distinction between the types draws from the order in which these wave arrive to a given location: $p$-waves are primary waves and $s$-waves are secondary waves.\cite[57]{stein2009introduction}. Stein provides an excellent visual of the difference between the two, shown in Figure \ref{fig:spwaves}.

When talking about seismic waves, it is common to refer the direction of propagation of the wave as the $z$-axis, with the $x$-axis pointing outside the ground and the $y$-axis pointing parallel to the ground.

$S$-waves displace the field in a direction orthogonal to the propagation of the wave. This is also known as a \textit{transverse wave}. As is typical for transverse waves, such as light \cite[57]{stein2009introduction}, $s$-waves have two independent polarizations. Therefore, we refer to the two polarization as $SH$ waves, where displacements happen in the $y-z$ plane and $SV$ planes, where displacements happen in the $x-z$ plane. 
On the other hand, a $p$-wave displaces the field in the same direction as the propagation of the wave, in other words, on the $z$-axis. This is also known as a \textit{longitudinal wave}\cite[57]{stein2009introduction}.

The focus of this project will be on the longitudinal waves caused by seismic faults: the $p$-waves.

%All waves have a particular direction of travel--the vector along which the wave itself propagates. In addition to this, the wave also has another vector of interest: the direction in which the wave's field is 



\section{Continuum mechanics}
\subsection{Stress tensor and wave equation}
We would like to solve the equation of motion to obtain solutions representing the wave functions of our compressional waves. We assume the soil is an isotropic elastic material. We have our equation of motion \cite[47]{stein2009introduction}:
\begin{align}
    \partials{\sigma_{ij}(\vb{x},t)}{x_j}+f_i(\vb{x},t) &= \rho\partials{^2 u_i(\vb{x},t)}{t^2}
\end{align}
Where $\sigma$ is our strain tensor, $f_i$ are body forces and $u$ is our displacement vector. In our case, we assume the fault has already passed and there is therefore no body force, such that:
\begin{align}
    \label{eqn:motion}
    \partials{\sigma_{ij}(\vb{x},t)}{x_j} &= \rho\partials{^2 u_i(\vb{x},t)}{t^2}   
\end{align}
We observe the specific case where $i=x$ and let $j$ be the free index:
\begin{align}
    \label{eqn:iex}
    \partials{\sigma_{xx}}{x}+\partials{\sigma_{xy}}{y}+\partials{\sigma_{xz}}{z} &= \rho \partials{^2 u_x}{t^2}
\end{align}
Now, we have that the constitutive equation for an isotropic material is \cite[50]{stein2009introduction}:
\begin{align}
    \sigma_{ij} &= \lambda e_{kk} \delta_{ij} +2\mu e_{ij}
\end{align}
Let us define:
\begin{align*}
    \gamma = \partials{u_i}{x_i} = e_{ii}
\end{align*}
Where $\gamma$ represents dilatation, giving us:
\begin{align}
    \sigma_{ij} &= \lambda \gamma \delta_{ij} +2\mu e_{ij}
\end{align}
Where $e$ is our strain tensor and $\lambda$ and $\mu$ are LamÃ© coefficients.
\begin{align*}
    \sigma_{xx} &= \lambda \gamma+2\mu e_{xx} = \lambda \gamma+2\mu \partials{u_x}{x}\\
    \sigma_{xy} &= 2\mu e_{xy} = 2\mu\left(\partials{u_x}{y}+\partials{u_y}{x}\right)\\
    \sigma_{xz} &= 2\mu e_{xz} = 2\mu\left(\partials{u_x}{z}+\partials{u_z}{x}\right)
\end{align*}
We then find the relevent spacial partials:
\begin{align*}
    \partials{\sigma_{xx}}{x} &= \lambda\partials{\gamma}{x}+2\mu\partials{e_{xx}}{x}\\
    \partials{\sigma_{xy}}{y} &= 2\mu\left(\partials{^2u_x}{y^2}+\partials{^2u_y}{y\partial x}\right)\\
    \partials{\sigma_{xz}}{z} &= 2\mu\left(\partials{^2u_x}{z^2}+\partials{^2u_z}{z\partial x}\right)
\end{align*}
We evaluate $\partials{\gamma}{x}$:
\begin{align*}
    \partials{\gamma}{x} &= \partials{}{x}\left(\partials{u_x}{x}+\partials{u_y}{y}+\partials{u_z}{z}\right)\\
    &= \partials{^2 u_x}{x^2}+\partials{^2 u_y}{x\partial y}+\partials{^2 u_z}{x\partial z}
\end{align*}
Finally, we input everything back into \ref{eqn:iex}:
\begin{align}
    \lambda\left(\partials{^2 u_x}{x^2}+\partials{^2 u_y}{x\partial y}+\partials{^2 u_z}{x\partial z}\right)+2\mu\left(\partials{^2u_x}{y^2}+\partials{^2u_y}{y\partial x}\right)+2\mu\left(\partials{^2u_x}{z^2}+\partials{^2u_z}{z\partial x}\right) &= \rho\partials{^2u_x}{t^2}
\end{align}
We rearrange slightly:
\begin{align*}
    (\lambda+\mu)\left(\partials{^2 u_x}{x^2}+\partials{^2 u_y}{x\partial y}+\partials{^2 u_z}{x\partial z}\right)+\mu\left(\partials{^2 u_x}{x^2}+\partials{^2 u_x}{y^2}+\partials{^2 u_x}{z^2}\right)&= \rho\partials{^2u_x}{t^2}
\end{align*}
We recognize the $x$ partial of the dilatation in the first term as well as the laplacian in the second term:
\begin{align}
    (\lambda+\mu)\partials{\gamma}{x}+\mu\nabla^2 u_x&= \rho\partials{^2u_x}{t^2}
\end{align}
We can repeat this process for $i=y$ and $i=z$ and see that we can generalize this previous equation as such:
\begin{align}
    (\lambda+\mu)\vb{\nabla \gamma}+\mu\vb{\nabla^2 u} &= \rho\partials{^2 \vb{u}}{t^2}
\end{align}
In terms of displacement alone:
\begin{align}
    \label{eqn:naive}
    (\lambda+\mu)\vb{\nabla(\nabla\cdot u)}+\mu\vb{\nabla^2 u} &= \rho\partials{^2 \vb{u}}{t^2}
\end{align}
Using the following identity \cite[54]{stein2009introduction}:
\begin{align}
    \label{eqn:id1}
    \vb{\nabla^2 u} &= \vb{\nabla(\nabla\cdot u)-\nabla\cross(\nabla\cross u)}
\end{align}
Equation \ref{eqn:naive} becomes:
\begin{align}
    (\lambda+2\mu)\vb{\nabla(\nabla\cdot u)}-\mu\vb{\nabla\cross(\nabla\cross u)} &= \rho\partials{^2 \vb{u}}{t^2}
\end{align}
If we define our displacement field as a sum of scalar potentials and vector potentials as such:
\begin{align*}
    \vb{u}(\vb{x},t) &= \nabla \phi(\vb{x}, t)+\nabla\cross\vb{\Psi}(\vb{x},t)
\end{align*}
And use the following vector identities\cite[54]{stein2009introduction}:
\begin{align*}
    \nabla\cross(\nabla\phi) &= 0\\
    \nabla\cdot(\nabla\cross\vb{\Psi}) &= 0
\end{align*}
We get:
\begin{align*}
    (\lambda+2\mu)\nabla(\nabla^2\phi)-\mu\nabla\cross\nabla\cross(\nabla\cross\vb{\Psi}) &= \rho\partials{^2}{t^2}(\nabla \phi+\nabla\cross\vb{\Psi})
\end{align*}
If we reuse \ref{eqn:id1}, we can calculate the second term on the left hand side to be:
\begin{align}
    \nabla\cross\nabla\cross(\nabla\cross\vb{\Psi}) &= -\nabla^2(\nabla\cross\vb{\Psi})+\nabla(\nabla\cdot(\nabla\cross\vb{\Psi}))\\
    &= -\nabla^2(\nabla\cross\vb{\Psi})
\end{align}
Yielding:
\begin{align*}
    (\lambda+2\mu)\nabla(\nabla^2\phi)+\mu\nabla^2(\nabla\cross\vb{\Psi}) &= \rho\partials{^2}{t^2}(\nabla \phi+\nabla\cross\vb{\Psi})
\end{align*}
Rearranging to isolate the scalar potential and the vector potential gives us:
\begin{align}
    \nabla\left[(\lambda+2\mu)\nabla^2\phi-\rho\partials{^2\phi}{t^2}\right] &= -\nabla\cross\left[\mu\nabla^2\vb{\Psi}-\rho\partials{^2\vb{\Psi}}{t^2}\right]
\end{align}
The left hand side of this equation represents the scalar wave function and the right hand side represents the vector wave function. Setting either side equal to 0 gives us differential equations allowing us to solve independently for either scalar or vector wave functions:
\begin{align}
    (\lambda+2\mu)\nabla^2\phi&=\rho\partials{^2\phi}{t^2}\label{eqn:scalar}\\
    \mu\nabla^2\vb{\Psi}&=\rho\partials{^2\vb{\Psi}}{t^2}
\end{align}
In our case, $p$-waves are strictly scalar waves and as such, working with \ref{eqn:scalar} will be sufficient. If we rearrange it, we obtain:
\begin{align*}
    \nabla^2\phi&=\frac{\rho}{(\lambda+2\mu)}\partials{^2\phi}{t^2}
\end{align*}
And define:
\begin{align*}
    \nu &= \sqrt{\frac{(\lambda+2\mu)}{\rho}}
\end{align*}
We get:
\begin{align}
    \nabla^2\phi&=\frac{1}{\nu^2}\partials{^2\phi}{t^2}
\end{align}
We recognize this to be the 3D scalar wave equation with wave speed $\nu$.
\subsection{Plane wave approximation}
% wave propagation/focus on P-waves
While seismic waves caused by faults are spherical, as is shown in figure \ref{fig:plane}, far from their origin, these waves can be well approximated as planar waves. We recall the 3D scalar wave equation:
\begin{align}
    \label{eqn:wave}
    \lap{\phi}(\vb{x}, t) &= \frac{1}{\nu^2}\partials{^2\phi(\vb{x}, t)}{t^2}
\end{align}
Here, $\nu$ is a constant typically associated with wave speed, and $\phi$ corresponds to our wavefunction. The family of solutions to the 1D equivalent of the scalar wave equation is:
\begin{align}
    \phi(x,t) &= Ae^{i(\omega t\pm kx)}
\end{align}
With $\omega$ representing the frequency of the wave, $k$ representing the \textit{wavenumber} and $A$ being a constant of integration. This 1D solution can easily be generalized to a 3D solution:
\begin{align}
    \phi(\vb{x}, t) &= Ae^{i(\omega t \pm \vb{k}\cdot\vb{x})}
\end{align}
Where $\vb{k}$ and $\vb{x}$ are now vectors representing the same physical values. In our case, we are working with $p$-waves only, which act longitudinally. Therefore, we can clearly define:
\begin{align*}
    \vb{k} &= (0,0,k)
\end{align*}
This gives us the following solution for the approximation of a $p$-wave as a planar wave:
\begin{align}
    \phi(\vb{x}, t) &= Ae^{i(\omega t \pm kz)}
\end{align}
We can then find the displacement caused by $p$-waves by taking the gradient of the wavefunction. Note that we arbitrarily choose the sign in the exponent to be negative:
\begin{align}
    \vb{u}(z,t)=\nabla \phi = (0,0,-ik) Ae^{i(\omega t-kz)},
\end{align}
Noting that this vector exists purely as a $z$-component, meaning that the displacement changes \textit{only} in the direction of the propagation of the wave.
We take the divergence of this $\vb{u}$ to obtain the expression for the dilatation of the material:
\begin{align}
    \nabla\cdot\vb{u}(z,t) = -k^2Ae^{i(\omega t-kz)}
\end{align}
Note that this divergence is nonzero, so a volume change occurs. In particular, the material compresses and expands periodically with respect to the $z$ and $t$ coordinates. The curl here is identically zero, since $\nabla\cross\del{\nabla\phi}=0$. 

\subsection{Spherical wave}

We recall the Laplacian operator in spherical coordinates:
\begin{align}
    \nabla^2 &= \frac{1}{r^2}\partials{}{r}\left(r^2\partials{}{r}\right)+\frac{1}{r^2\sin\theta}\partials{}{\theta}\left(\sin\theta\partials{}{\theta}\right)+\frac{1}{r^2\sin^2\theta}\partials{^2}{\varphi^2}
\end{align}
Such that:
\begin{align}
    \label{eqn:lapl}
    \nabla^2 \phi(\vb{r},t) = \frac{1}{r^2}\partials{}{r}\left(r^2\partials{\phi(\vb{r},t)}{r}\right)+\frac{1}{r^2\sin\theta}\partials{}{\theta}\left(\sin\theta\partials{\phi(\vb{r},t)}{\theta}\right)+\frac{1}{r^2\sin^2\theta}\partials{^2\phi(\vb{r},t)}{\varphi^2}
\end{align}
Where $\vb{r}$ is our spherical position vector:
\begin{align*}
    \vb{r} &= (r,\theta,\varphi)
\end{align*}
For spherical waves, we know our wavefunction depends only on the radial component $r$:
\begin{align*}
    \phi(\vb{r},t) &= \phi(r,t)
\end{align*}
Such that \ref{eqn:lapl} has only non-zero terms for partials of radius:
\begin{align}
    \nabla^2 \phi(\vb{r},t) = \frac{1}{r^2}\partials{}{r}\left(r^2\partials{\phi(\vb{r},t)}{r}\right)
\end{align}
We substitute this in our wave equation (\ref{eqn:wave}):
\begin{align}
    \label{eqn:interm}
    \nabla^2 \phi(\vb{r},t) &= \frac{1}{\nu^2}\partials{^2 \phi(\vb{r},t)}{t}\\
    \frac{1}{r^2}\partials{}{r}\left(r^2\partials{\phi(\vb{r},t)}{r}\right) &= \frac{1}{\nu^2}\partials{^2 \phi(\vb{r},t)}{t^2}
\end{align}
Let us define:
\begin{align*}
    \phi(r,t) &= \frac{\xi(r,t)}{r}
\end{align*}
Such that \ref{eqn:interm} becomes:
\begin{gather*}
    \frac{1}{r^2}\partials{}{r}\left(r^2\partials{}{r}\frac{\xi(r,t)}{r}\right) = \frac{1}{\nu^2}\partials{^2 }{t^2}\frac{\xi(r,t)}{r}\\
    \frac{1}{r}\partials{}{r}\left(r\partials{\xi(r,t)}{r}-\xi(r,t)\right) = \frac{1}{\nu^2}\partials{^2 \xi(r,t)}{t^2}\\
    \frac{1}{r}\left(r\partials{^2\xi(r,t)}{r^2}+\xi(r,t)-\xi(r,t)\right) = \frac{1}{\nu^2}\partials{^2 \xi(r,t)}{t^2}\\
    \partials{^2\xi(r,t)}{r^2}= \frac{1}{\nu^2}\partials{^2 \xi(r,t)}{t^2}
\end{gather*}
We notice that this is the 1D wave equation, which has the following solution:
\begin{align*}
    \xi(r,t) &= Be^{i(\omega t \pm \nu r)}
\end{align*}
Such that our wavefunction is of the family:
\begin{align}
    \phi(r,t) &= \frac{B}{r}e^{i(\omega t \pm \nu r)}
\end{align}
% stress

% strain


\subsection{Interface between materials}
As expected, the Earth is not an isotropic material. However, at very large scales it may be possible to invoke simplifying assumptions such that a usable model is possible. Since the diameter of the earth is large, concentric spherical layers of the various materials making up earth's crust can be approximated as planes. This depends on the scale of the problem being studied.  % TODO: finish writing about the layers n stuff from page 67

In this project, we assume the simplified case of two interfacing homogeneous materials. The familiar Snell's Law can actually be used here to model the propagation of a wave through the boundary between two materials.
% this section mainly explains how SH and SV waves are decoupled/independent and there is no change in volume. 
% apparent velocity
As the wave propagates beneath the surface of the earth in its particular direction of travel, the wave reaches the surface after some time delay. This travel velocity as it would appear from an observer's point of view on the earth's surface is called the \textit{apparent velocity}, given by $c_x$ \cite[65]{stein2009introduction}.

% plane wave changes direction when it crosses an interface with a different seismic velocity --> seismic rays and ray paths
A wave traveling from medium 1 to medium 2 will partly transmit through the boundary layer, and partly reflect back into medium 1. 
Snell's Law is given by \cite[67]{stein2009introduction} as
\begin{align}
    c_x = \frac{\nu_1}{\sin i_1} = \frac{\nu_2}{\sin i_2},
\end{align} where $c_x$ is the apparent velocity. Figure \ref{fig:reflection} illustrates the reflection and transmission onto the interface between two materials with Snell's Law. This is given by the following potential:
\begin{align}
    \phi(x,z,t)&=\textrm{incident P}+\textrm{reflected P}\\
    &=A_1e^{i(\omega t-k_xx-k_xr_{\nu_1}z)}
    +A_2e^{i(\omega t-k_xx+k_xr_{\nu_1}z)},
\end{align}
where we note that the reflected wave is proportional to the incident wave, but reflected in its direction of travel ($z$). The wavenumbers correlate to material properties and wave types \cite[66]{stein2009introduction}.
As for the transmission of the $p$-wave, the potential is given by,
\begin{align}
    \phi(x,z,t)=\textrm{transmitted P}=A'e^{i(\omega t-k_xx-k_xr_{\nu_2}z})
\end{align}
where $A'$ is the amplitude of the wave.


